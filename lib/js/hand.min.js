var HANDJS=HANDJS||{};!function(){function a(){v=!0,clearTimeout(w),w=setTimeout(function(){v=!1},700)}function b(a,b){for(;a;){if(a.contains(b))return a;a=a.parentNode}return null}function c(a,c,d){for(var e=b(a,c),f=a,g=[];f&&f!==e;)m(f,"pointerenter")&&g.push(f),f=f.parentNode;for(;g.length>0;)d(g.pop())}function d(a,c,d){for(var e=b(a,c),f=a;f&&f!==e;)m(f,"pointerleave")&&d(f),f=f.parentNode}function e(a,b){["pointerdown","pointermove","pointerup","pointerover","pointerout"].forEach(function(c){window.addEventListener(a(c),function(a){!v&&n(a.target,c)&&b(a,c,!0)})}),void 0===window["on"+a("pointerenter").toLowerCase()]&&window.addEventListener(a("pointerover"),function(a){if(!v){var d=n(a.target,"pointerenter");d&&d!==window&&(d.contains(a.relatedTarget)||c(d,a.relatedTarget,function(c){b(a,"pointerenter",!1,c,a.relatedTarget)}))}}),void 0===window["on"+a("pointerleave").toLowerCase()]&&window.addEventListener(a("pointerout"),function(a){if(!v){var c=n(a.target,"pointerleave");c&&c!==window&&(c.contains(a.relatedTarget)||d(c,a.relatedTarget,function(c){b(a,"pointerleave",!1,c,a.relatedTarget)}))}})}if(!window.PointerEvent){Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);e<c;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){if(!(this&&a instanceof Function))throw new TypeError;for(var c=0;c<this.length;c++)a.call(b,this[c],c,this)}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")});var f=["pointerdown","pointerup","pointermove","pointerover","pointerout","pointercancel","pointerenter","pointerleave"],g=["PointerDown","PointerUp","PointerMove","PointerOver","PointerOut","PointerCancel","PointerEnter","PointerLeave"],h={},i=function(a){for(;a&&!a.handjs_forcePreventDefault;)a=a.parentNode;return!!a||window.handjs_forcePreventDefault},j=function(a,b,c,d,e){var f;if(document.createEvent?(f=document.createEvent("MouseEvents"),f.initMouseEvent(b,c,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,e||a.relatedTarget)):(f=document.createEventObject(),f.screenX=a.screenX,f.screenY=a.screenY,f.clientX=a.clientX,f.clientY=a.clientY,f.ctrlKey=a.ctrlKey,f.altKey=a.altKey,f.shiftKey=a.shiftKey,f.metaKey=a.metaKey,f.button=a.button,f.relatedTarget=e||a.relatedTarget),void 0===f.offsetX&&(void 0!==a.offsetX?(Object&&void 0!==Object.defineProperty&&(Object.defineProperty(f,"offsetX",{writable:!0}),Object.defineProperty(f,"offsetY",{writable:!0})),f.offsetX=a.offsetX,f.offsetY=a.offsetY):Object&&void 0!==Object.defineProperty?(Object.defineProperty(f,"offsetX",{get:function(){return this.currentTarget&&this.currentTarget.offsetLeft?a.clientX-this.currentTarget.offsetLeft:a.clientX}}),Object.defineProperty(f,"offsetY",{get:function(){return this.currentTarget&&this.currentTarget.offsetTop?a.clientY-this.currentTarget.offsetTop:a.clientY}})):void 0!==a.layerX&&(f.offsetX=a.layerX-a.currentTarget.offsetLeft,f.offsetY=a.layerY-a.currentTarget.offsetTop)),void 0!==a.isPrimary?f.isPrimary=a.isPrimary:f.isPrimary=!0,a.pressure)f.pressure=a.pressure;else{var g=0;void 0!==a.which?g=a.which:void 0!==a.button&&(g=a.button),f.pressure=0===g?0:.5}if(a.rotation?f.rotation=a.rotation:f.rotation=0,a.hwTimestamp?f.hwTimestamp=a.hwTimestamp:f.hwTimestamp=0,a.tiltX?f.tiltX=a.tiltX:f.tiltX=0,a.tiltY?f.tiltY=a.tiltY:f.tiltY=0,a.height?f.height=a.height:f.height=0,a.width?f.width=a.width:f.width=0,f.preventDefault=function(){void 0!==a.preventDefault&&a.preventDefault()},void 0!==f.stopPropagation){var h=f.stopPropagation;f.stopPropagation=function(){void 0!==a.stopPropagation&&a.stopPropagation(),h.call(this)}}switch(f.pointerId=a.pointerId,f.pointerType=a.pointerType,f.pointerType){case 2:f.pointerType="touch";break;case 3:f.pointerType="pen";break;case 4:f.pointerType="mouse"}d?d.dispatchEvent(f):a.target?a.target.dispatchEvent(f):a.srcElement.fireEvent("on"+p(b),f)},k=function(a,b,c,d,e){a.pointerId=1,a.pointerType="mouse",j(a,b,c,d,e)},l=function(a,b,c,d,e,f){var g=b.identifier+2;b.pointerId=g,b.pointerType="touch",b.currentTarget=c,void 0!==d.preventDefault&&(b.preventDefault=function(){d.preventDefault()}),j(b,a,e,c,f)},m=function(a,b){return a.__handjsGlobalRegisteredEvents&&a.__handjsGlobalRegisteredEvents[b]},n=function(a,b){for(;a&&!m(a,b);)a=a.parentNode;return a||(m(window,b)?window:void 0)},o=function(a,b,c,d,e,f){n(c,a)&&l(a,b,c,d,e,f)},p=function(a){return a.toLowerCase().replace("pointer","mouse")},q=function(a,b){var c=f.indexOf(b);return a+g[c]},r=function(a,b,c,d){if(void 0===a.__handjsRegisteredEvents&&(a.__handjsRegisteredEvents=[]),d){if(void 0!==a.__handjsRegisteredEvents[b])return void a.__handjsRegisteredEvents[b]++;a.__handjsRegisteredEvents[b]=1,a.addEventListener(b,c,!1)}else{if(-1!==a.__handjsRegisteredEvents.indexOf(b)&&0!==--a.__handjsRegisteredEvents[b])return;a.removeEventListener(b,c),a.__handjsRegisteredEvents[b]=0}},s=function(a,b,c){if(a.__handjsGlobalRegisteredEvents||(a.__handjsGlobalRegisteredEvents=[]),c){if(void 0!==a.__handjsGlobalRegisteredEvents[b])return void a.__handjsGlobalRegisteredEvents[b]++;a.__handjsGlobalRegisteredEvents[b]=1}else void 0!==a.__handjsGlobalRegisteredEvents[b]&&--a.__handjsGlobalRegisteredEvents[b]<0&&(a.__handjsGlobalRegisteredEvents[b]=0);var d,e;switch(window.MSPointerEvent?(d=function(a){return q("MS",a)},e=j):(d=p,e=k),b){case"pointerenter":case"pointerleave":var f=d(b);void 0!==a["on"+f.toLowerCase()]&&r(a,f,function(a){e(a,b)},c)}},t=function(a){var b=a.prototype?a.prototype.addEventListener:a.addEventListener,c=function(a,c,d){-1!==f.indexOf(a)&&s(this,a,!0),void 0===b?this.attachEvent("on"+p(a),c):b.call(this,a,c,d)};a.prototype?a.prototype.addEventListener=c:a.addEventListener=c},u=function(a){var b=a.prototype?a.prototype.removeEventListener:a.removeEventListener,c=function(a,c,d){-1!==f.indexOf(a)&&s(this,a,!1),void 0===b?this.detachEvent(p(a),c):b.call(this,a,c,d)};a.prototype?a.prototype.removeEventListener=c:a.removeEventListener=c};t(window),t(window.HTMLElement||window.Element),t(document),navigator.isCocoonJS||(t(HTMLBodyElement),t(HTMLDivElement),t(HTMLImageElement),t(HTMLUListElement),t(HTMLAnchorElement),t(HTMLLIElement),t(HTMLTableElement),window.HTMLSpanElement&&t(HTMLSpanElement)),window.HTMLCanvasElement&&t(HTMLCanvasElement),!navigator.isCocoonJS&&window.SVGElement&&t(SVGElement),u(window),u(window.HTMLElement||window.Element),u(document),navigator.isCocoonJS||(u(HTMLBodyElement),u(HTMLDivElement),u(HTMLImageElement),u(HTMLUListElement),u(HTMLAnchorElement),u(HTMLLIElement),u(HTMLTableElement),window.HTMLSpanElement&&u(HTMLSpanElement)),window.HTMLCanvasElement&&u(HTMLCanvasElement),!navigator.isCocoonJS&&window.SVGElement&&u(SVGElement);var v=!1,w=-1;!function(){window.MSPointerEvent?e(function(a){return q("MS",a)},j):(e(p,k),void 0!==window.ontouchstart&&(window.addEventListener("touchstart",function(b){for(var d=0;d<b.changedTouches.length;++d){var e=b.changedTouches[d];h[e.identifier]=e.target,o("pointerover",e,e.target,b,!0),c(e.target,null,function(a){l("pointerenter",e,a,b,!1)}),o("pointerdown",e,e.target,b,!0)}a()}),window.addEventListener("touchend",function(b){for(var c=0;c<b.changedTouches.length;++c){var e=b.changedTouches[c],f=h[e.identifier];o("pointerup",e,f,b,!0),o("pointerout",e,f,b,!0),d(f,null,function(a){l("pointerleave",e,a,b,!1)})}a()}),window.addEventListener("touchmove",function(b){for(var e=0;e<b.changedTouches.length;++e){var f=b.changedTouches[e],g=document.elementFromPoint(f.clientX,f.clientY),j=h[f.identifier];if(j&&!0===i(j)&&b.preventDefault(),o("pointermove",f,j,b,!0),!navigator.isCocoonJS){var g=document.elementFromPoint(f.clientX,f.clientY);if(j===g)continue;j&&(o("pointerout",f,j,b,!0,g),j.contains(g)||d(j,g,function(a){l("pointerleave",f,a,b,!1,g)})),g&&(o("pointerover",f,g,b,!0,j),g.contains(j)||c(g,j,function(a){l("pointerenter",f,a,b,!1,j)})),h[f.identifier]=g}}a()}),window.addEventListener("touchcancel",function(a){for(var b=0;b<a.changedTouches.length;++b){var c=a.changedTouches[b];o("pointercancel",c,h[c.identifier],a,!0)}})))}(),void 0===navigator.pointerEnabled&&(navigator.pointerEnabled=!0,navigator.msPointerEnabled&&(navigator.maxTouchPoints=navigator.msMaxTouchPoints))}}();
